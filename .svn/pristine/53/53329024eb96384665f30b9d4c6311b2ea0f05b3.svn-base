package com.cms.service.impl;

import java.util.ArrayList;
import java.util.List;

import org.apache.http.NameValuePair;
import org.apache.http.message.BasicNameValuePair;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import com.cms.bean.ResponseWrapper;
import com.cms.service.AccountService;
import com.cms.util.Configurator;
import com.cms.util.HttpUtil;


public class AccountServiceImpl implements AccountService{
	
	private static final Logger logger = LoggerFactory.getLogger(AccountServiceImpl.class);
	
	/**
	 * Reset Agent Password
	 * @param agentId
	 * @param userId
	 * @param sessionId
	 * @param mgrUsername
	 * @param channel ->[email, sms]
	 * @param value ->[email address, mobileNo]
	 * @return
	 */
	public ResponseWrapper processResetPassword(String requestType, String userId, String sessionId, String subUserId, String accountType,  String accountID, String channel, String value){
		logger.debug("Inside processResetPassword");

		ResponseWrapper result = null;
		List<NameValuePair> params = new ArrayList<NameValuePair>();

		params.add(new BasicNameValuePair("requestType", "ResetPassword"));
		params.add(new BasicNameValuePair("userId", userId));
		params.add(new BasicNameValuePair("sessionId", sessionId));
		params.add(new BasicNameValuePair("subUserId", subUserId));
		params.add(new BasicNameValuePair("accountID", accountID));
		params.add(new BasicNameValuePair("accountType", accountType));
		params.add(new BasicNameValuePair("channel", channel));
		params.add(new BasicNameValuePair("value",value));

		final String url = Configurator.getConfig("webportal.url");

		result = HttpUtil.sendPost(url, params);

		logger.debug("Exiting processResetPassword(result=)");
		return result;
	}
	
	public ResponseWrapper processChangePassword(String userId, String sessionId, String subUserId, String accountType, String accountID, String newPassword){
		logger.debug("Inside processChangePassword");

		ResponseWrapper result = null;
		List<NameValuePair> params = new ArrayList<NameValuePair>();

		params.add(new BasicNameValuePair("requestType", "ResetPassword"));
		params.add(new BasicNameValuePair("userId", userId));
		params.add(new BasicNameValuePair("sessionId", sessionId));
		params.add(new BasicNameValuePair("subUserId", subUserId));
		params.add(new BasicNameValuePair("accountID", accountID));
		params.add(new BasicNameValuePair("accountType", accountType));
		params.add(new BasicNameValuePair("newPassword", newPassword));

		final String url = Configurator.getConfig("webportal.url");

		result = HttpUtil.sendPost(url, params);

		logger.debug("Exiting processChangePassword(result=)");
		return result;
	}
}